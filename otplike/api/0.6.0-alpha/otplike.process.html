<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>otplike.process documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Otplike</span> <span class="project-version">0.6.0-alpha</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>otplike</span></div></div></li><li class="depth-2 branch"><a href="otplike.async-ext.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async-ext</span></div></a></li><li class="depth-2 branch"><a href="otplike.gen-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gen-server</span></div></a></li><li class="depth-2 branch"><a href="otplike.proc-util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proc-util</span></div></a></li><li class="depth-2 branch current"><a href="otplike.process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>process</span></div></a></li><li class="depth-2 branch"><a href="otplike.supervisor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>supervisor</span></div></a></li><li class="depth-2 branch"><a href="otplike.timer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timer</span></div></a></li><li class="depth-2"><a href="otplike.trace.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>trace</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="otplike.process.html#var-.21"><div class="inner"><span>!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-alive.3F"><div class="inner"><span>alive?</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-async"><div class="inner"><span>async</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-async-value"><div class="inner"><span>async-value</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-async.3F"><div class="inner"><span>async?</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-await.21"><div class="inner"><span>await!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-await.21.21"><div class="inner"><span>await!!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-await.3F.21"><div class="inner"><span>await?!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-demonitor"><div class="inner"><span>demonitor</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-ex-.3Ereason"><div class="inner"><span>ex-&gt;reason</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-ex-catch"><div class="inner"><span>ex-catch</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-exit"><div class="inner"><span>exit</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-flag"><div class="inner"><span>flag</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-IProcFn"><div class="inner"><span>IProcFn</span></div></a></li><li class="depth-2"><a href="otplike.process.html#var-call"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>call</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-link"><div class="inner"><span>link</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-map-async"><div class="inner"><span>map-async</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-monitor"><div class="inner"><span>monitor</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-pid-.3Estr"><div class="inner"><span>pid-&gt;str</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-pid.3F"><div class="inner"><span>pid?</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-proc-defn"><div class="inner"><span>proc-defn</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-proc-defn-"><div class="inner"><span>proc-defn-</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-proc-fn"><div class="inner"><span>proc-fn</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-process-info"><div class="inner"><span>process-info</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-processes"><div class="inner"><span>processes</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-receive.21"><div class="inner"><span>receive!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-receive.21.21"><div class="inner"><span>receive!!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-ref.3F"><div class="inner"><span>ref?</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-registered"><div class="inner"><span>registered</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-resolve-pid"><div class="inner"><span>resolve-pid</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-selective-receive.21"><div class="inner"><span>selective-receive!</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-self"><div class="inner"><span>self</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-spawn"><div class="inner"><span>spawn</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-spawn-link"><div class="inner"><span>spawn-link</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-spawn-opt"><div class="inner"><span>spawn-opt</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-trace"><div class="inner"><span>trace</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-unlink"><div class="inner"><span>unlink</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-untrace"><div class="inner"><span>untrace</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-whereis"><div class="inner"><span>whereis</span></div></a></li><li class="depth-1"><a href="otplike.process.html#var-with-async"><div class="inner"><span>with-async</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">otplike.process</h1><div class="doc"><div class="markdown"><p>This namespace implements core process concepts such as spawning, linking, monitoring, message passing and exiting.</p>
<h3><a href="#process-context" name="process-context"></a>Process context</h3>
<p>All the calls made from process function directly or indirectly after it has been spawned happen in the context of the process (i.e., are issued by the process).</p>
<h3><a href="#process-exit" name="process-exit"></a>Process exit</h3>
<p>A process exits when:</p>
<ul>
  <li>it receives exit signal with reason <code>:kill</code>,</li>
  <li>it receives exit signal with the reason other than <code>:kill</code>, and it  doesn’t trap exits,</li>
  <li>its initial function ends (returning a value or with exception).</li>
</ul>
<p>As there is no way to force process function to stop execution after its process has exited, a process can be <em>alive</em> or <em>exiting</em>:</p>
<ul>
  <li>a process is alive until it exits for any reason,</li>
  <li>a process becomes exiting after it exited until it’s initial  function returns.</li>
</ul>
<p>There can be cases when exiting process tries to communicate with other processes. In such cases exception with the reason <code>:noproc</code> is thrown.</p>
<p>The following happens when a process exits:</p>
<ul>
  <li>its mailbox becomes closed so that no future messages can be received,</li>
  <li>all linked/monitoring processes receive exit/down signal,</li>
  <li>it can not be reached using its pid,</li>
  <li>it is no longer registered.</li>
</ul>
<h3><a href="#signals-control-messages-" name="signals-control-messages-"></a>Signals (control messages)</h3>
<p>Signals are used internally to manage processes. Exiting, monitoring, linking and some other operations require sending signals (not messages) to involved processes.</p></div></div><div class="public anchor" id="var-.21"><h3>!</h3><div class="usage"><code>(! dest message)</code></div><div class="doc"><div class="markdown"><p>Sends a <code>message</code> to <code>dest</code>. <code>dest</code> can be a process identifier, or a registered name.</p>
<p>Returns <code>true</code> if <code>message</code> was sent (<code>dest</code> process existed), false otherwise.</p>
<p>Throws if any of arguments is <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L783">view source</a></div></div><div class="public anchor" id="var-alive.3F"><h3>alive?</h3><div class="usage"><code>(alive?)</code><code>(alive? pid)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if the process exists and is alive, that is, is not exiting and has not exited. Otherwise returns <code>false</code>.</p>
<p>When called without arguments, returns information about the calling process.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1273">view source</a></div></div><div class="public anchor" id="var-async"><h3>async</h3><h4 class="type">macro</h4><div class="usage"><code>(async &amp; body)</code></div><div class="doc"><div class="markdown"><p>Executes body asynchronously. Like go-block but propagates exceptions.</p>
<p>The returned value is to be passed to <code>await!</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1201">view source</a></div></div><div class="public anchor" id="var-async-value"><h3>async-value</h3><div class="usage"><code>(async-value value)</code></div><div class="doc"><div class="markdown"><p>Wraps <code>value</code> into async value.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1268">view source</a></div></div><div class="public anchor" id="var-async.3F"><h3>async?</h3><div class="usage"><code>(async? x)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if <code>x</code> is async value (i.e. is returned by <code>async</code>), otherwise returns <code>false</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1225">view source</a></div></div><div class="public anchor" id="var-await.21"><h3>await!</h3><h4 class="type">macro</h4><div class="usage"><code>(await! x)</code></div><div class="doc"><div class="markdown"><p>Returns the value of the async operation represented by <code>x</code> or exits with the same reason the operation exited. Parks until the operation is completed if required.</p>
<p>It is illegal to pass the same async value to <code>await!</code> more than once.</p>
<p>Throws if <code>x</code> is not async value (i.e. is not returned by <code>async</code>).</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1209">view source</a></div></div><div class="public anchor" id="var-await.21.21"><h3>await!!</h3><div class="usage"><code>(await!! x)</code></div><div class="doc"><div class="markdown"><p>The same as <code>await!</code> but blocks.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1220">view source</a></div></div><div class="public anchor" id="var-await.3F.21"><h3>await?!</h3><h4 class="type">macro</h4><div class="usage"><code>(await?! x)</code></div><div class="doc"><div class="markdown"><p>If <code>x</code> is returned by <code>async</code>, returns the value of the corresponding async operation (parks if needed). If <code>x</code> is a regular value, returns <code>x</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1231">view source</a></div></div><div class="public anchor" id="var-demonitor"><h3>demonitor</h3><div class="usage"><code>(demonitor mref)</code><code>(demonitor mref {flush? :flush})</code></div><div class="doc"><div class="markdown"><p>If <code>mref</code> is a reference that the calling process obtained by calling monitor, this monitoring is turned off. If the monitoring is already turned off, nothing happens. If <code>mref</code> is created by other process, nothing happens.</p>
<p>Once demonitor has returned, it is guaranteed that no <code>[:DOWN monitor-ref _ _ _]</code> message, because of the monitor, will be placed in the caller message queue in the future. A <code>[:DOWN monitor-ref _ _ _]</code> message can have been placed in the caller message queue before the call, though. It is therefore usually advisable to remove such a <code>:DOWN</code> message from the message queue after monitoring has been stopped. <code>(demonitor mref {:flush true})</code> can be used instead of <code>(demonitor mref)</code> if this cleanup is wanted.</p>
<p>When <code>:flush</code> option is <code>true</code>, removes (one) <code>:DOWN</code> message, if there is one, from the caller message queue after monitoring has been stopped. This is equivalent to the following:</p>
<pre><code>(demonitor mref)
(selective-receive!
  [_ mref _ _ _] true
  (after 0
    true))
</code></pre>
<p>Returns <code>true</code>.</p>
<p>Throws when called not in process context, or calling process is not alive, or <code>mref</code> is not a ref.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1039">view source</a></div></div><div class="public anchor" id="var-ex-.3Ereason"><h3>ex-&gt;reason</h3><div class="usage"><code>(ex-&gt;reason e)</code></div><div class="doc"><div class="markdown"><p>Creates exit reason from exception.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L726">view source</a></div></div><div class="public anchor" id="var-ex-catch"><h3>ex-catch</h3><h4 class="type">macro</h4><div class="usage"><code>(ex-catch expr)</code></div><div class="doc"><div class="markdown"><p>Executes <code>expr</code>. Returns either result of execution or <code>[:EXIT reason]</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L732">view source</a></div></div><div class="public anchor" id="var-exit"><h3>exit</h3><div class="usage"><code>(exit reason)</code><code>(exit pid reason)</code></div><div class="doc"><div class="markdown"><p><strong>When called with one argument (reason)</strong></p>
<p>Throws special exception (which can be caught). When the exception leaves process’ initial function, it causes the process to exit with the specified reason.</p>
<p><strong>When called with two arguments (pid and reason)</strong></p>
<p>Sends an exit signal with the reason <code>reason</code> to the process identified by <code>pid</code>.</p>
<p>If reason is any term, except <code>:normal</code> or <code>:kill</code>:</p>
<ul>
  <li>if <code>pid</code> is not trapping exits, <code>pid</code> itself exits with exit reason.</li>
  <li>if <code>pid</code> is trapping exits, the exit signal is transformed into a  message <code>[:EXIT from reason]</code> and delivered to the message queue  of <code>pid</code>. <code>from</code> is the process identifier of the process that sent  the exit signal.</li>
</ul>
<p>If reason is <code>:normal</code>, <code>pid</code> does not exit. If <code>pid</code> is trapping exits, the exit signal is transformed into a message <code>[:EXIT from :normal]</code> and delivered to its message queue.</p>
<p>If reason is <code>:kill</code>, an untrappable exit signal is sent to pid, which unconditionally exits with reason <code>:killed</code>.</p>
<p>Notice that process can exit with other reason before exit signal is processed.</p>
<p>Returns <code>true</code> if exit signal was sent (<code>dest</code> process existed), <code>false</code> otherwise.</p>
<p>Throws when called not in process context, if calling process is not alive, if <code>pid</code> is not a pid, or reason is <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L801">view source</a></div></div><div class="public anchor" id="var-flag"><h3>flag</h3><div class="usage"><code>(flag flag value)</code></div><div class="doc"><div class="markdown"><p>Sets the value of a process’ flag. See description of each flag below.</p>
<p>Flags:</p>
<ul>
  <li><code>:trap-exit</code>. When set to <code>true</code>, exit signals arriving to a process are converted to <code>[:EXIT from reason]</code> messages, which can be received as ordinary messages. If is set to <code>false</code>, the process exits if it receives an exit signal other than <code>:normal</code> and the exit signal is propagated to its linked processes.</li>
</ul>
<p>Returns the old value of a <code>flag</code>.</p>
<p>Throws when called not in process context.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L851">view source</a></div></div><div class="public anchor" id="var-IProcFn"><h3>IProcFn</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-call"><h3>call</h3><div class="usage"><code>(call _ pid args)</code></div><div class="doc"><div class="markdown"></div></div></div></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L84">view source</a></div></div><div class="public anchor" id="var-link"><h3>link</h3><div class="usage"><code>(link pid)</code></div><div class="doc"><div class="markdown"><p>Creates a link between the calling process and another process identified by <code>pid</code>, if there is not such a link already. If a process attempts to create a link to itself, nothing is done.</p>
<p>If pid does not exist and the calling process</p>
<ol>
  <li>is trapping exits - the calling process receives message <code>[:EXIT pid :noproc]</code>.</li>
  <li>is not trapping exits - process exits with reason <code>:noproc</code>.</li>
</ol>
<p>Returns <code>true</code>.</p>
<p>Throws when called not in process context, or calling process is not alive, or <code>pid</code> is not a pid.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L886">view source</a></div></div><div class="public anchor" id="var-map-async"><h3>map-async</h3><div class="usage"><code>(map-async f async-val)</code></div><div class="doc"><div class="markdown"><p>Creates a copy of <code>async-val</code> adding <code>f</code> to the list of its transformation functions.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1241">view source</a></div></div><div class="public anchor" id="var-monitor"><h3>monitor</h3><div class="usage"><code>(monitor pid-or-name)</code></div><div class="doc"><div class="markdown"><p>Sends a monitor request to the entity identified by <code>pid-or-name</code>. If the monitored entity does not exist or when it dies, the caller of monitor will be notified by a message of the following format:</p>
<pre><code>[tag monitor-ref type object info]
</code></pre>
<p><code>type</code> can be one of the following keywords: <code>:process</code>.</p>
<p>A monitor is triggered only once, after that it is removed from both monitoring process and the monitored entity. Monitors are fired when the monitored process terminates, or does not exist at the moment of creation. The monitoring is also turned off when <code>demonitor</code> is called.</p>
<p>When monitoring by name please note, that the registered-name is resolved to pid only once at the moment of monitor instantiation, later changes to the name registration will not affect the existing monitor.</p>
<p>When a monitor is triggered, a <code>:DOWN</code> message that has the following pattern</p>
<pre><code>[:DOWN monitor-ref type object info]
</code></pre>
<p>is sent to the monitoring process.</p>
<p>In monitor message <code>monitor-ref</code> and <code>type</code> are the same as described earlier, and:</p>
<ul>
  <li><code>object</code> - the monitored entity, which triggered the event. That is the  argument of monitor call.</li>
  <li><code>info</code> - either the exit reason of the process, or <code>:noproc</code>  (process did not exist at the time of monitor creation).</li>
</ul>
<p>Making several calls to <code>monitor</code> for the same <code>pid-or-name</code> is not an error; it results in as many independent monitoring instances.</p>
<p>Monitoring self does nothing.</p>
<p>Returns <code>monitor-ref</code>.</p>
<p>Throws when called not in process context, or if calling process is not alive.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L969">view source</a></div></div><div class="public anchor" id="var-pid-.3Estr"><h3>pid-&gt;str</h3><div class="usage"><code>(pid-&gt;str pid)</code></div><div class="doc"><div class="markdown"><p>Returns a string corresponding to the text representation of <code>pid</code>.</p>
<p>Throws if <code>pid</code> is not a process identifier.</p>
<p><strong>Warning:</strong> this function is intended for debugging and is not to be used in application programs.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L755">view source</a></div></div><div class="public anchor" id="var-pid.3F"><h3>pid?</h3><div class="usage"><code>(pid? pid)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if <code>pid</code> is a process identifier, <code>false</code> otherwise.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L741">view source</a></div></div><div class="public anchor" id="var-proc-defn"><h3>proc-defn</h3><h4 class="type">macro</h4><div class="usage"><code>(proc-defn fname doc-string? args &amp; body)</code></div><div class="doc"><div class="markdown"><p>The same as <code>(def fname (proc-fn args body))</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1184">view source</a></div></div><div class="public anchor" id="var-proc-defn-"><h3>proc-defn-</h3><h4 class="type">macro</h4><div class="usage"><code>(proc-defn- fname args &amp; body)</code></div><div class="doc"><div class="markdown"><p>The same as proc-defn, but defines a private var.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1196">view source</a></div></div><div class="public anchor" id="var-proc-fn"><h3>proc-fn</h3><h4 class="type">macro</h4><div class="usage"><code>(proc-fn name-or-args &amp; args-body)</code></div><div class="doc"><div class="markdown"><p>Creates process function which can be passed to <code>spawn</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1177">view source</a></div></div><div class="public anchor" id="var-process-info"><h3>process-info</h3><div class="usage"><code>(process-info pid)</code><code>(process-info pid item-or-list)</code></div><div class="doc"><div class="markdown"><h2><code>(process-info pid)</code></h2>
<p>Returns a map containing information about the process identified by <code>pid</code>, or <code>nil</code> if the process is not alive.</p>
<p>All items are <strong>not</strong> mandatory. The set of info-tuples being part of the result can be changed without prior notice.</p>
<p>The following info-tuples are part of the result: <code>:initial-call</code>, <code>:status</code>, <code>:message-queue-len</code>, <code>:links</code>, <code>:flags</code>.</p>
<p>If the process identified by <code>pid</code> has a registered name, also an info-tuple for <code>:registered-name</code> is included.</p>
<blockquote>
  <p><strong>Warning!</strong> This function is intended for debugging only. For all other purposes, use <code>(process-info pid item-or-list)</code>.</p>
</blockquote>
<p>Throws if <code>pid</code> is not a pid.</p>
<h2><code>(process-info pid item-or-list)</code></h2>
<p>Returns information about the process identified by <code>pid</code>, as specified by into-key or info-key list. Returns <code>nil</code> if the process is not alive.</p>
<p>If the process is alive and a single info-key is specified, the returned value is the corresponding info-tuple.</p>
<pre><code class="clojure">(process-info pid :messages)
=&gt; [:messages [:msg1 [:msg2] {:msg3 3}]]
</code></pre>
<p>If a list of info-keys is specified, the result is a list of info-tuples. The info-tuples in the list are included in the same order as the keys were included in info-key list. Valid items can be included multiple times in item-key list.</p>
<p>Info-tuples:</p>
<p><code>[:initial-call [fn-symbol arity]]</code></p>
<p><code>fn-symbol</code>, <code>arity</code> is the initial function call with which the process was spawned.</p>
<p><code>[:links pids]</code></p>
<p><code>pids</code> is a list of process identifiers, with processes to which the process has a link.</p>
<p><code>[:message-queue-len message-queue-len]</code></p>
<p><code>message-queue-len</code> is the number of messages currently in the message queue of the process. This is the length of the list <code>message-queue</code> returned as the information item messages (see below).</p>
<p><code>[:messages message-queue]</code></p>
<p><code>message-queue</code> is a list of the messages to the process,which have not yet been processed.</p>
<p><code>[:monitored-by pids]</code></p>
<p>A list of process identifiers monitoring the process.</p>
<p><code>[:monitors monitors]</code></p>
<p>A list of monitors that are active for the process. The list consists of pids and registered names.</p>
<p><code>[:registered-name reg-name]</code></p>
<p><code>reg-name</code> is the registered process name or <code>nil</code> if the process has no registered name.</p>
<p><code>[:status status]</code></p>
<p><code>status</code> is the status of the process and is one of the following:</p>
<ul>
  <li><code>:exiting</code></li>
  <li><code>:waiting</code> (for a message)</li>
  <li><code>:running</code></li>
</ul>
<p><code>[:trace trace-flags]</code></p>
<p>A map of trace flags set for the process. <em>This info-tuple is not available now but it is reserved for future.</em></p>
<p><code>[:flags flags]</code></p>
<p>A map of flags set for the process (e.g., <code>{:trap-exit true}</code>).</p>
<p>Throws if <code>pid</code> is not a pid, or specified info-key doesn’t exist.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1297">view source</a></div></div><div class="public anchor" id="var-processes"><h3>processes</h3><div class="usage"><code>(processes)</code></div><div class="doc"><div class="markdown"><p>Returns a sequence of process identifiers corresponding to all the processes currently existing.</p>
<p>Notice that an exiting process exists, but is not alive. That is, <code>(alive? pid)</code> returns <code>false</code> for an exiting process, but its process identifier is part of the result returned from <code>(processes)</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1286">view source</a></div></div><div class="public anchor" id="var-receive.21"><h3>receive!</h3><h4 class="type">macro</h4><div class="usage"><code>(receive! &amp; clauses)</code></div><div class="doc"><div class="markdown"><p>Receives and removes from the inbox the first message sent to the process using the <code>!</code> function:</p>
<pre><code>(receive!
  pattern1 pattern-expr1
  pattern2 pattern-expr2
  ...)
</code></pre>
<p>The message is matched using <code>clojure.core.match/match</code> against the patterns. If a match succeeds, the corresponding expression is evaluated, otherwise throws. It is illegal to use a <code>receive!</code> with no patterns.</p>
<p>If there are no messages in the inbox, the execution is suspended, possibly indefinitely, until the first message arrives.</p>
<p>The receive expression can be augmented with a timeout:</p>
<pre><code>(receive!
  pattern pattern-expr
  ...
  (after timeout
    timeout-expr))
</code></pre>
<p>There are two special cases for the <code>timeout</code> value: <code>:infinity</code> - the process is to wait indefinitely for a matching  message. This is the same as not using a timeout. This can be  useful for timeout values that are calculated at runtime. <code>0</code> - if there is no messages in the mailbox, or the first message  doesn’t match, the timeout occurs immediately.</p>
<p>Returns the value of the evaluated expression.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1132">view source</a></div></div><div class="public anchor" id="var-receive.21.21"><h3>receive!!</h3><h4 class="type">macro</h4><div class="usage"><code>(receive!! &amp; clauses)</code></div><div class="doc"><div class="markdown"><p>The same as <code>receive!</code> but blocks.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1172">view source</a></div></div><div class="public anchor" id="var-ref.3F"><h3>ref?</h3><div class="usage"><code>(ref? x)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if <code>x</code> is a reference, <code>false</code> otherwise.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L721">view source</a></div></div><div class="public anchor" id="var-registered"><h3>registered</h3><div class="usage"><code>(registered)</code></div><div class="doc"><div class="markdown"><p>Returns a set of names of the processes that have been registered.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L880">view source</a></div></div><div class="public anchor" id="var-resolve-pid"><h3>resolve-pid</h3><div class="usage"><code>(resolve-pid pid-or-name)</code></div><div class="doc"><div class="markdown"><p>If <code>pid-or-name</code> is a pid - returns pid. If a registered name - returns the pid of registered process. Else returns <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L746">view source</a></div></div><div class="public anchor" id="var-selective-receive.21"><h3>selective-receive!</h3><h4 class="type">macro</h4><div class="usage"><code>(selective-receive! &amp; clauses)</code></div><div class="doc"><div class="markdown"><p>The same as <code>receive!</code> but doesn’t crash if the first message doesn’t match. Instead waits for the matching message, removes it from the mailbox leaving all the rest messages in the original order.</p>
<p>When the timeout is <code>0</code>, checks all the messages in the mailbox and not the first one only.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L959">view source</a></div></div><div class="public anchor" id="var-self"><h3>self</h3><div class="usage"><code>(self)</code></div><div class="doc"><div class="markdown"><p>Returns the process identifier of the calling process. Throws when called not in process context, or process is not alive.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L767">view source</a></div></div><div class="public anchor" id="var-spawn"><h3>spawn</h3><div class="usage"><code>(spawn proc-func)</code><code>(spawn proc-func args)</code></div><div class="doc"><div class="markdown"><p>Returns the process identifier of a new process started by the application of <code>proc-fun</code> to <code>args</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1111">view source</a></div></div><div class="public anchor" id="var-spawn-link"><h3>spawn-link</h3><div class="usage"><code>(spawn-link proc-func)</code><code>(spawn-link proc-func args)</code></div><div class="doc"><div class="markdown"><p>Returns the process identifier of a new process started by the application of <code>proc-fun</code> to <code>args</code>. A link is created between the calling process and the new process, atomically. Otherwise works like <code>spawn</code>.</p>
<p>Throws when called not in process context, or calling process is not alive.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1119">view source</a></div></div><div class="public anchor" id="var-spawn-opt"><h3>spawn-opt</h3><div class="usage"><code>(spawn-opt proc-func opts)</code><code>(spawn-opt proc-func args opts)</code></div><div class="doc"><div class="markdown"><p>Returns the process identifier of a new process started by the application of <code>proc-fun</code> to <code>args</code>.</p>
<p><code>options</code> argument is a map of option names (keywords) to their values.</p>
<p>The following options are allowed:</p>
<ul>
  <li><code>:flags</code> - a map of process’ flags (e.g. <code>{:trap-exit true}</code>)</li>
  <li><code>:link</code> - if <code>true</code>, sets a link to the parent process</li>
  <li><code>:register</code> - name to register the process, can not be pid, if name is  <code>nil</code> process will not be registered</li>
</ul>
<p>Throws</p>
<ul>
  <li>when there is another process registered under the same name,</li>
  <li>on invalid arguments.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1088">view source</a></div></div><div class="public anchor" id="var-trace"><h3>trace</h3><div class="usage"><code>(trace pred handler)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1419">view source</a></div></div><div class="public anchor" id="var-unlink"><h3>unlink</h3><div class="usage"><code>(unlink pid)</code></div><div class="doc"><div class="markdown"><p>Removes the link, if there is one, between the calling process and the process referred to by <code>pid</code>.</p>
<p>Returns <code>true</code>.</p>
<p>Does not fail if there is no link to <code>pid</code>, if <code>pid</code> is self pid, or if <code>pid</code> does not exist.</p>
<p>Once <code>unlink</code> has returned, it is guaranteed that the link between the caller and the entity referred to by <code>pid</code> has no effect on the caller in the future (unless the link is setup again).</p>
<p>If the caller is trapping exits, an <code>[:EXIT pid _]</code> message from the link can have been placed in the caller’s message queue before the call.</p>
<p>Notice that the <code>[:EXIT pid _]</code> message can be the result of the link, but can also be the result of pid calling exit. Therefore, it can be appropriate to clean up the message queue when trapping exits after the call to unlink.</p>
<p>Throws when called not in process context, or calling process is not alive, or <code>pid</code> is not a pid.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L921">view source</a></div></div><div class="public anchor" id="var-untrace"><h3>untrace</h3><div class="usage"><code>(untrace)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1424">view source</a></div></div><div class="public anchor" id="var-whereis"><h3>whereis</h3><div class="usage"><code>(whereis reg-name)</code></div><div class="doc"><div class="markdown"><p>Returns the process identifier with the registered name <code>reg-name</code>, or <code>nil</code> if the name is not registered.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L776">view source</a></div></div><div class="public anchor" id="var-with-async"><h3>with-async</h3><h4 class="type">macro</h4><div class="usage"><code>(with-async [binding-form async-expr :as bindings] &amp; body)</code></div><div class="doc"><div class="markdown"><p>Wraps <code>body</code> into a function with binding-form as its single argument.</p>
<p>Returns <code>(map-async body-fn async-expr-result)</code>.</p>
<p>Works as a recursion point for <code>body</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.6.0-alpha/src/otplike/process.clj#L1252">view source</a></div></div></div></body></html>