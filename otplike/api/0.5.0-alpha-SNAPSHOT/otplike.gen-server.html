<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>otplike.gen-server documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Otplike</span> <span class="project-version">0.5.0-alpha-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>otplike</span></div></div></li><li class="depth-2 branch"><a href="otplike.async-ext.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async-ext</span></div></a></li><li class="depth-2 branch current"><a href="otplike.gen-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gen-server</span></div></a></li><li class="depth-2 branch"><a href="otplike.proc-util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proc-util</span></div></a></li><li class="depth-2 branch"><a href="otplike.process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>process</span></div></a></li><li class="depth-2 branch"><a href="otplike.supervisor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>supervisor</span></div></a></li><li class="depth-2 branch"><a href="otplike.timer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timer</span></div></a></li><li class="depth-2"><a href="otplike.trace.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>trace</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="otplike.gen-server.html#var-call"><div class="inner"><span>call</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-call.21"><div class="inner"><span>call!</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-cast"><div class="inner"><span>cast</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-IGenServer"><div class="inner"><span>IGenServer</span></div></a></li><li class="depth-2 branch"><a href="otplike.gen-server.html#var-handle-call"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-call</span></div></a></li><li class="depth-2 branch"><a href="otplike.gen-server.html#var-handle-cast"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-cast</span></div></a></li><li class="depth-2 branch"><a href="otplike.gen-server.html#var-handle-info"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-info</span></div></a></li><li class="depth-2 branch"><a href="otplike.gen-server.html#var-init"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2"><a href="otplike.gen-server.html#var-terminate"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>terminate</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-reply"><div class="inner"><span>reply</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start"><div class="inner"><span>start</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start.21"><div class="inner"><span>start!</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start-link"><div class="inner"><span>start-link</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start-link.21"><div class="inner"><span>start-link!</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start-link-ns"><div class="inner"><span>start-link-ns</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start-link-ns.21"><div class="inner"><span>start-link-ns!</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start-ns"><div class="inner"><span>start-ns</span></div></a></li><li class="depth-1"><a href="otplike.gen-server.html#var-start-ns.21"><div class="inner"><span>start-ns!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">otplike.gen-server</h1><div class="doc"><div class="markdown"><p>gen-server behaviour and related functions.</p></div></div><div class="public anchor" id="var-call"><h3>call</h3><div class="usage"><code>(call server request)</code><code>(call server request timeout-ms)</code></div><div class="doc"><div class="markdown"><p>The same as <code>call!</code> but returns async value.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L457">view source</a></div></div><div class="public anchor" id="var-call.21"><h3>call!</h3><h4 class="type">macro</h4><div class="usage"><code>(call! server request)</code><code>(call! server request timeout-ms)</code></div><div class="doc"><div class="markdown"><p>Makes a synchronous call to a <code>server</code> by sending a <code>request</code> and waiting until a reply arrives or a time-out occurs. The <code>handle-call</code> callback of the gen-server is called to handle the request.</p>
<p><code>server</code> can be a pid or a registered name.</p>
<p><code>request</code> is any form that is passed as the <code>request</code> arguments to <code>handle-call</code>.</p>
<p><code>timeout-ms</code> is an integer greater than zero that specifies how many milliseconds to wait for a reply, or the keyword <code>:infinity</code> to wait indefinitely. Defaults to 5000. If no reply is received within the specified time, the function call fails. If the caller catches the failure and continues running, and the server is just late with the reply, it can arrive at any time later into the message queue of the caller. The caller must in this case be prepared for this and discard any such garbage messages that are two element tuples with a reference as the first element.</p>
<p>The return value is defined in the return value of <code>handle-call</code>.</p>
<p>The call can fail for many reasons, including time-out and the called gen-server process dying before or during the call.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L422">view source</a></div></div><div class="public anchor" id="var-cast"><h3>cast</h3><div class="usage"><code>(cast server request)</code></div><div class="doc"><div class="markdown"><p>Sends an asynchronous request to the <code>server</code> and returns immediately, ignoring if the <code>server</code> process does not exist. The <code>handle-cast</code> callback of the gen-server is called to handle the request.</p>
<p><code>request</code> is any form that is passed as the <code>request</code> argument to <code>handle-cast</code>.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L464">view source</a></div></div><div class="public anchor" id="var-IGenServer"><h3>IGenServer</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-handle-call"><h3>handle-call</h3><div class="usage"><code>(handle-call _ request from state)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-handle-cast"><h3>handle-cast</h3><div class="usage"><code>(handle-cast _ request state)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-handle-info"><h3>handle-info</h3><div class="usage"><code>(handle-info _ request state)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-init"><h3>init</h3><div class="usage"><code>(init _ args)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-terminate"><h3>terminate</h3><div class="usage"><code>(terminate _ reason state)</code></div><div class="doc"><div class="markdown"></div></div></div></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L16">view source</a></div></div><div class="public anchor" id="var-reply"><h3>reply</h3><div class="usage"><code>(reply [mref pid :as _from] response)</code></div><div class="doc"><div class="markdown"><p>This function can be used to explicitly send a reply to a client that called <code>call*</code> or, when the reply cannot be defined in the return value of <code>handle-call</code>. This allows processing <code>call*</code> requests asynchronously.</p>
<p>Client must be the <code>from</code> argument provided to the <code>handle-call</code> callback. <code>reply</code> is given back to the client as the return value of <code>call*</code>.</p>
<p>The return value is not further defined, and is always to be ignored.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L474">view source</a></div></div><div class="public anchor" id="var-start"><h3>start</h3><div class="usage"><code>(start server)</code><code>(start server args)</code><code>(start server args options)</code><code>(start reg-name server args options)</code></div><div class="doc"><div class="markdown"><p>The same as <code>start!</code> but returns async value.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L310">view source</a></div></div><div class="public anchor" id="var-start.21"><h3>start!</h3><h4 class="type">macro</h4><div class="usage"><code>(start! server)</code><code>(start! server args)</code><code>(start! server args options)</code><code>(start! reg-name server args options)</code></div><div class="doc"><div class="markdown"><p>Starts the server, passing <code>args</code> to server’s <code>init</code> function.</p>
<p>Arguments: <code>server-impl</code> - <code>IGenServer</code> implementation, or map, or namespace. <code>args</code> - any form that is passed as the argument to init function.</p>
<p>Options: <code>:timeout</code> - time in milliseconds gen-server is allowed to spend  initializing or it is terminated and the start function returns  <code>[:error :timeout]</code>. <code>:spawn-opt</code> - options used to spawn the gen-server process (see  <code>process/spawn-opt</code>)</p>
<p>Returns: <code>[:ok pid]</code> if server started successfully, <code>[:error :no-init]</code> if server implementation doesn’t provide <code>init</code> function, <code>[:error [:bad-return-value value]]</code> if <code>init</code> returns a bad value, <code>[:error reason]</code> otherwise.</p>
<p>Throws on illegal arguments.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L321">view source</a></div></div><div class="public anchor" id="var-start-link"><h3>start-link</h3><div class="usage"><code>(start-link server)</code><code>(start-link server args)</code><code>(start-link server args options)</code><code>(start-link reg-name server args options)</code></div><div class="doc"><div class="markdown"><p>The same as <code>start-link!</code> but returns async value.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L353">view source</a></div></div><div class="public anchor" id="var-start-link.21"><h3>start-link!</h3><h4 class="type">macro</h4><div class="usage"><code>(start-link! server)</code><code>(start-link! server args)</code><code>(start-link! server args options)</code><code>(start-link! reg-name server args options)</code></div><div class="doc"><div class="markdown"><p>The same as <code>start!</code> but atomically links caller to started process.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L364">view source</a></div></div><div class="public anchor" id="var-start-link-ns"><h3>start-link-ns</h3><h4 class="type">macro</h4><div class="usage"><code>(start-link-ns)</code><code>(start-link-ns args)</code><code>(start-link-ns args options)</code><code>(start-link-ns reg-name args options)</code></div><div class="doc"><div class="markdown"><p>The same as <code>start-link-ns!</code> but returns async value.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L399">view source</a></div></div><div class="public anchor" id="var-start-link-ns.21"><h3>start-link-ns!</h3><h4 class="type">macro</h4><div class="usage"><code>(start-link-ns!)</code><code>(start-link-ns! args)</code><code>(start-link-ns! args options)</code><code>(start-link-ns! reg-name args options)</code></div><div class="doc"><div class="markdown"><p>The same as <code>start-ns!</code> but atomically links caller to started process.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L410">view source</a></div></div><div class="public anchor" id="var-start-ns"><h3>start-ns</h3><h4 class="type">macro</h4><div class="usage"><code>(start-ns)</code><code>(start-ns args)</code><code>(start-ns args options)</code><code>(start-ns reg-name args options)</code></div><div class="doc"><div class="markdown"><p>The same as <code>start-ns!</code> but returns async value.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L376">view source</a></div></div><div class="public anchor" id="var-start-ns.21"><h3>start-ns!</h3><h4 class="type">macro</h4><div class="usage"><code>(start-ns!)</code><code>(start-ns! args)</code><code>(start-ns! args options)</code><code>(start-ns! reg-name args options)</code></div><div class="doc"><div class="markdown"><p>Starts the server, taking current ns as an implementation source. See <code>start!</code> for more info.</p></div></div><div class="src-link"><a href="https://github.com/suprematic/otplike/blob/0.5.0-alpha-SNAPSHOT/src/otplike/gen_server.clj#L387">view source</a></div></div></div></body></html>